name: ROS2 CI (Humble) - colcon build & test
# name: This is what youâ€™ll see in the GitHub "Actions" tab. 

on:
  pull_request:
    # pull_request: Run CI for PRs so failures are caught before merging.
  push:
    branches: [ main ]
    # branches: Limit push-trigger to main so you don't run twice (once on feature push + once on PR).
    # Alternative: remove branches filter to run on every branch push.

jobs:
  build_and_test:
    runs-on: ubuntu-22.04
    # runs-on: GitHub-hosted runner OS. Ubuntu 22.04 matches ROS2 Humble's common base (Jammy).
    # Alternative: use ubuntu-latest, but that may change OS version over time.

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        # uses: Runs a reusable GitHub Action.
        # checkout: pulls your repository code into the runner workspace.

      - name: Setup ROS 2 (Humble) tools and environment
        uses: ros-tooling/setup-ros@v0.7
        with:
          required-ros-distributions: humble
        # setup-ros installs ROS tooling; it will not install ROS by default unless you pass required-ros-distributions. 
        # required-ros-distributions: tells the action to install that ROS distro (here: humble). 

      - name: Build and test with colcon (action-ros-ci)
        uses: ros-tooling/action-ros-ci@v0.3
        with:
          target-ros2-distro: humble
        # action-ros-ci builds & tests a ROS/ROS2 workspace using colcon. 
        # target-ros2-distro: which ROS2 distro to target for the build/test environment.
